"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),r=require("@react-three/fiber"),t=require("three"),n=require("./OrthographicCamera.cjs.js"),u=require("./useCamera.cjs.js");function o(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),r.default=e,Object.freeze(r)}require("@babel/runtime/helpers/extends"),require("@babel/runtime/helpers/objectWithoutPropertiesLoose"),require("react-merge-refs");var a=o(e),i=a.createContext({}),c=2*Math.PI,s=new t.Object3D,l=new t.Matrix4,f=new t.Quaternion,p=new t.Quaternion,d=new t.Vector3,h=new t.Vector3,m=new t.Quaternion;exports.GizmoHelper=function(e){var o=e.alignment,g=void 0===o?"bottom-right":o,b=e.margin,v=void 0===b?[80,80]:b,w=e.onUpdate,j=e.onTarget,y=e.children,q=r.useThree((function(e){return e.size})),x=r.useThree((function(e){return e.camera})),O=r.useThree((function(e){return e.gl})),T=r.useThree((function(e){return e.scene})),k=r.useThree((function(e){return e.invalidate})),C=a.useRef(),P=a.useRef(),R=a.useRef(null),M=a.useState((function(){return new t.Scene}))[0],E=a.useRef(!1),z=a.useRef(0),D=a.useRef(new t.Vector3(0,0,0));a.useEffect((function(){return T.background&&(C.current=T.background,T.background=null,M.background=C.current),function(){C.current&&(T.background=C.current)}}),[]);r.useFrame((function(e,r){var t;R.current&&P.current&&(!function(e){if(k(),E.current){var r=e*c;f.rotateTowards(p,r),x.position.set(0,0,1).applyQuaternion(f).multiplyScalar(z.current).add(D.current),x.quaternion.rotateTowards(m,r),x.updateProjectionMatrix(),w&&w(),f.angleTo(p)<.01&&(E.current=!1)}}(r),l.copy(x.matrix).invert(),null==(t=P.current)||t.quaternion.setFromRotationMatrix(l),O.autoClear=!1,O.clearDepth(),O.render(M,R.current))}));var Q={tweenCamera:function(e){console.log("..."),E.current=!0,D.current=j(),z.current=x.position.distanceTo(d),s.position.copy(d),s.lookAt(x.position),f.copy(s.quaternion),h.copy(e).multiplyScalar(z.current).add(d),s.lookAt(h),p.copy(s.quaternion),k()},raycast:u.useCamera(R)},S=v[0],_=v[1],V=g.endsWith("-left")?-q.width/2+S:q.width/2-S,W=g.startsWith("top-")?q.height/2-_:-q.height/2+_;return r.createPortal(a.createElement(i.Provider,{value:Q},a.createElement(n.OrthographicCamera,{ref:R,makeDefault:!1,position:[0,0,200]}),a.createElement("group",{ref:P,position:[V,W,0]},y)),M)},exports.useGizmoContext=function(){return a.useContext(i)};
