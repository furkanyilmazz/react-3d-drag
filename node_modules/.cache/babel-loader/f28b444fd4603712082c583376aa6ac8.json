{"ast":null,"code":"// https://stackoverflow.com/questions/1248302/how-to-get-the-size-of-a-javascript-object\nfunction getPrimitiveSize(el) {\n  switch (typeof el) {\n    case 'number':\n      return 8;\n\n    case 'string':\n      return el.length * 2;\n\n    case 'boolean':\n      return 4;\n\n    default:\n      return 0;\n  }\n}\n\nfunction isTypedArray(arr) {\n  var regex = /(Uint|Int|Float)(8|16|32)Array/;\n  return regex.test(arr.constructor.name);\n}\n\nfunction getRootExtremes(bvh, group) {\n  var result = {\n    total: 0,\n    depth: {\n      min: Infinity,\n      max: -Infinity\n    },\n    tris: {\n      min: Infinity,\n      max: -Infinity\n    },\n    splits: [0, 0, 0]\n  };\n  bvh.traverse(function (depth, isLeaf, boundingData, offsetOrSplit, count) {\n    result.total++;\n\n    if (isLeaf) {\n      result.depth.min = Math.min(depth, result.depth.min);\n      result.depth.max = Math.max(depth, result.depth.max);\n      result.tris.min = Math.min(count, result.tris.min);\n      result.tris.max = Math.max(count, result.tris.max);\n    } else {\n      result.splits[offsetOrSplit]++;\n    }\n  }, group); // If there are no leaf nodes because the tree hasn't finished generating yet.\n\n  if (result.tris.min === Infinity) {\n    result.tris.min = 0;\n    result.tris.max = 0;\n  }\n\n  if (result.depth.min === Infinity) {\n    result.depth.min = 0;\n    result.depth.max = 0;\n  }\n\n  return result;\n}\n\nfunction getBVHExtremes(bvh) {\n  return bvh._roots.map(function (root, i) {\n    return getRootExtremes(bvh, i);\n  });\n}\n\nfunction estimateMemoryInBytes(obj) {\n  var traversed = new Set();\n  var stack = [obj];\n  var bytes = 0;\n\n  while (stack.length) {\n    var curr = stack.pop();\n\n    if (traversed.has(curr)) {\n      continue;\n    }\n\n    traversed.add(curr);\n\n    for (var key in curr) {\n      if (!curr.hasOwnProperty(key)) {\n        continue;\n      }\n\n      bytes += getPrimitiveSize(key);\n      var value = curr[key];\n\n      if (value && (typeof value === 'object' || typeof value === 'function')) {\n        if (isTypedArray(value)) {\n          bytes += value.byteLength;\n        } else if (value instanceof ArrayBuffer) {\n          bytes += value.byteLength;\n        } else {\n          stack.push(value);\n        }\n      } else {\n        bytes += getPrimitiveSize(value);\n      }\n    }\n  }\n\n  return bytes;\n}\n\nexport { estimateMemoryInBytes, getBVHExtremes };","map":{"version":3,"sources":["/Users/a2017/Documents/GitHub/react-3d-drag/node_modules/three-mesh-bvh/src/Utils/Debug.js"],"names":["getPrimitiveSize","el","length","isTypedArray","arr","regex","test","constructor","name","getRootExtremes","bvh","group","result","total","depth","min","Infinity","max","tris","splits","traverse","isLeaf","boundingData","offsetOrSplit","count","Math","getBVHExtremes","_roots","map","root","i","estimateMemoryInBytes","obj","traversed","Set","stack","bytes","curr","pop","has","add","key","hasOwnProperty","value","byteLength","ArrayBuffer","push"],"mappings":"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","sourcesContent":["// https://stackoverflow.com/questions/1248302/how-to-get-the-size-of-a-javascript-object\r\nfunction getPrimitiveSize( el ) {\r\n\r\n\tswitch ( typeof el ) {\r\n\r\n\t\tcase 'number':\r\n\t\t\treturn 8;\r\n\t\tcase 'string':\r\n\t\t\treturn el.length * 2;\r\n\t\tcase 'boolean':\r\n\t\t\treturn 4;\r\n\t\tdefault:\r\n\t\t\treturn 0;\r\n\r\n\t}\r\n\r\n}\r\n\r\nfunction isTypedArray( arr ) {\r\n\r\n\tconst regex = /(Uint|Int|Float)(8|16|32)Array/;\r\n\treturn regex.test( arr.constructor.name );\r\n\r\n}\r\n\r\nfunction getRootExtremes( bvh, group ) {\r\n\r\n\tconst result = {\r\n\t\ttotal: 0,\r\n\t\tdepth: {\r\n\t\t\tmin: Infinity, max: - Infinity\r\n\t\t},\r\n\t\ttris: {\r\n\t\t\tmin: Infinity, max: - Infinity\r\n\t\t},\r\n\t\tsplits: [ 0, 0, 0 ]\r\n\t};\r\n\r\n\tbvh.traverse( ( depth, isLeaf, boundingData, offsetOrSplit, count ) => {\r\n\r\n\t\tresult.total ++;\r\n\t\tif ( isLeaf ) {\r\n\r\n\t\t\tresult.depth.min = Math.min( depth, result.depth.min );\r\n\t\t\tresult.depth.max = Math.max( depth, result.depth.max );\r\n\r\n\t\t\tresult.tris.min = Math.min( count, result.tris.min );\r\n\t\t\tresult.tris.max = Math.max( count, result.tris.max );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tresult.splits[ offsetOrSplit ] ++;\r\n\r\n\t\t}\r\n\r\n\t}, group );\r\n\r\n\t// If there are no leaf nodes because the tree hasn't finished generating yet.\r\n\tif ( result.tris.min === Infinity ) {\r\n\r\n\t\tresult.tris.min = 0;\r\n\t\tresult.tris.max = 0;\r\n\r\n\t}\r\n\r\n\tif ( result.depth.min === Infinity ) {\r\n\r\n\t\tresult.depth.min = 0;\r\n\t\tresult.depth.max = 0;\r\n\r\n\t}\r\n\r\n\treturn result;\r\n\r\n}\r\n\r\nfunction getBVHExtremes( bvh ) {\r\n\r\n\treturn bvh._roots.map( ( root, i ) => getRootExtremes( bvh, i ) );\r\n\r\n}\r\n\r\nfunction estimateMemoryInBytes( obj ) {\r\n\r\n\tconst traversed = new Set();\r\n\tconst stack = [ obj ];\r\n\tlet bytes = 0;\r\n\r\n\twhile ( stack.length ) {\r\n\r\n\t\tconst curr = stack.pop();\r\n\t\tif ( traversed.has( curr ) ) {\r\n\r\n\t\t\tcontinue;\r\n\r\n\t\t}\r\n\t\ttraversed.add( curr );\r\n\r\n\t\tfor ( let key in curr ) {\r\n\r\n\t\t\tif ( ! curr.hasOwnProperty( key ) ) {\r\n\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbytes += getPrimitiveSize( key );\r\n\r\n\t\t\tconst value = curr[ key ];\r\n\t\t\tif ( value && ( typeof value === 'object' || typeof value === 'function' ) ) {\r\n\r\n\t\t\t\tif ( isTypedArray( value ) ) {\r\n\r\n\t\t\t\t\tbytes += value.byteLength;\r\n\r\n\t\t\t\t} else if ( value instanceof ArrayBuffer ) {\r\n\r\n\t\t\t\t\tbytes += value.byteLength;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tstack.push( value );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tbytes += getPrimitiveSize( value );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn bytes;\r\n\r\n}\r\n\r\nexport { estimateMemoryInBytes, getBVHExtremes };\r\n"]},"metadata":{},"sourceType":"module"}