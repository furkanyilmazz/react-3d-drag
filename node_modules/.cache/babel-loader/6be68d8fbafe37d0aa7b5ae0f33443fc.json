{"ast":null,"code":"import * as React from 'react';\nimport * as THREE from 'three';\nimport { useThree } from '@react-three/fiber';\nimport { Environment } from './Environment.js';\nimport { ContactShadows } from './ContactShadows.js';\nconst presets = {\n  rembrandt: {\n    main: [1, 2, 1],\n    fill: [-2, -0.5, -2]\n  },\n  portrait: {\n    main: [-1, 2, 0.5],\n    fill: [-1, 0.5, -1.5]\n  },\n  upfront: {\n    main: [0, 2, 1],\n    fill: [-1, 0.5, -1.5]\n  },\n  soft: {\n    main: [-2, 4, 4],\n    fill: [-1, 0.5, -1.5]\n  }\n};\n\nfunction Stage({\n  children,\n  controls,\n  shadows = true,\n  adjustCamera = true,\n  environment = 'city',\n  contactShadow = true,\n  intensity = 1,\n  preset = 'rembrandt',\n  shadowBias = 0,\n  contactShadowBlur = 2,\n  contactShadowOpacity = 0.5,\n  ...props\n}) {\n  const config = presets[preset];\n  const camera = useThree(state => state.camera);\n  const outer = React.useRef(null);\n  const inner = React.useRef(null);\n  const [{\n    radius,\n    width,\n    height\n  }, set] = React.useState({\n    radius: 0,\n    width: 0,\n    height: 0\n  });\n  React.useLayoutEffect(() => {\n    outer.current.position.set(0, 0, 0);\n    outer.current.updateWorldMatrix(true, true);\n    const box3 = new THREE.Box3().setFromObject(inner.current);\n    const center = new THREE.Vector3();\n    const sphere = new THREE.Sphere();\n    const height = box3.max.y - box3.min.y;\n    const width = box3.max.x - box3.min.x;\n    box3.getCenter(center);\n    box3.getBoundingSphere(sphere);\n    set({\n      radius: sphere.radius,\n      width,\n      height\n    });\n    outer.current.position.set(-center.x, -center.y + height / 2, -center.z);\n  }, [children]);\n  React.useLayoutEffect(() => {\n    if (adjustCamera) {\n      const y = radius / (height > width ? 1.5 : 2.5);\n      camera.position.set(0, radius * 0.5, radius * 2.5);\n      camera.near = 0.1;\n      camera.far = Math.max(5000, radius * 4);\n      camera.lookAt(0, y, 0);\n\n      if (controls && controls.current) {\n        controls.current.target.set(0, y, 0);\n        controls.current.update();\n      }\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [radius, height, width, adjustCamera]);\n  return /*#__PURE__*/React.createElement(\"group\", props, /*#__PURE__*/React.createElement(\"group\", {\n    ref: outer\n  }, /*#__PURE__*/React.createElement(\"group\", {\n    ref: inner\n  }, children)), contactShadow && /*#__PURE__*/React.createElement(ContactShadows, {\n    \"rotation-x\": Math.PI / 2,\n    opacity: contactShadowOpacity,\n    width: radius * 2,\n    height: radius * 2,\n    blur: contactShadowBlur,\n    far: radius / 2\n  }), environment && /*#__PURE__*/React.createElement(Environment, {\n    preset: environment\n  }), /*#__PURE__*/React.createElement(\"ambientLight\", {\n    intensity: intensity / 3\n  }), /*#__PURE__*/React.createElement(\"spotLight\", {\n    penumbra: 1,\n    position: [config.main[0] * radius, config.main[1] * radius, config.main[2] * radius],\n    intensity: intensity * 2,\n    castShadow: shadows,\n    \"shadow-bias\": shadowBias\n  }), /*#__PURE__*/React.createElement(\"pointLight\", {\n    position: [config.fill[0] * radius, config.fill[1] * radius, config.fill[2] * radius],\n    intensity: intensity\n  }));\n}\n\nexport { Stage };","map":{"version":3,"sources":["/Users/a2017/Documents/GitHub/react-3d-drag/node_modules/@react-three/drei/core/Stage.js"],"names":["React","THREE","useThree","Environment","ContactShadows","presets","rembrandt","main","fill","portrait","upfront","soft","Stage","children","controls","shadows","adjustCamera","environment","contactShadow","intensity","preset","shadowBias","contactShadowBlur","contactShadowOpacity","props","config","camera","state","outer","useRef","inner","radius","width","height","set","useState","useLayoutEffect","current","position","updateWorldMatrix","box3","Box3","setFromObject","center","Vector3","sphere","Sphere","max","y","min","x","getCenter","getBoundingSphere","z","near","far","Math","lookAt","target","update","createElement","ref","PI","opacity","blur","penumbra","castShadow"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport * as THREE from 'three';\nimport { useThree } from '@react-three/fiber';\nimport { Environment } from './Environment.js';\nimport { ContactShadows } from './ContactShadows.js';\n\nconst presets = {\n  rembrandt: {\n    main: [1, 2, 1],\n    fill: [-2, -0.5, -2]\n  },\n  portrait: {\n    main: [-1, 2, 0.5],\n    fill: [-1, 0.5, -1.5]\n  },\n  upfront: {\n    main: [0, 2, 1],\n    fill: [-1, 0.5, -1.5]\n  },\n  soft: {\n    main: [-2, 4, 4],\n    fill: [-1, 0.5, -1.5]\n  }\n};\nfunction Stage({\n  children,\n  controls,\n  shadows = true,\n  adjustCamera = true,\n  environment = 'city',\n  contactShadow = true,\n  intensity = 1,\n  preset = 'rembrandt',\n  shadowBias = 0,\n  contactShadowBlur = 2,\n  contactShadowOpacity = 0.5,\n  ...props\n}) {\n  const config = presets[preset];\n  const camera = useThree(state => state.camera);\n  const outer = React.useRef(null);\n  const inner = React.useRef(null);\n  const [{\n    radius,\n    width,\n    height\n  }, set] = React.useState({\n    radius: 0,\n    width: 0,\n    height: 0\n  });\n  React.useLayoutEffect(() => {\n    outer.current.position.set(0, 0, 0);\n    outer.current.updateWorldMatrix(true, true);\n    const box3 = new THREE.Box3().setFromObject(inner.current);\n    const center = new THREE.Vector3();\n    const sphere = new THREE.Sphere();\n    const height = box3.max.y - box3.min.y;\n    const width = box3.max.x - box3.min.x;\n    box3.getCenter(center);\n    box3.getBoundingSphere(sphere);\n    set({\n      radius: sphere.radius,\n      width,\n      height\n    });\n    outer.current.position.set(-center.x, -center.y + height / 2, -center.z);\n  }, [children]);\n  React.useLayoutEffect(() => {\n    if (adjustCamera) {\n      const y = radius / (height > width ? 1.5 : 2.5);\n      camera.position.set(0, radius * 0.5, radius * 2.5);\n      camera.near = 0.1;\n      camera.far = Math.max(5000, radius * 4);\n      camera.lookAt(0, y, 0);\n\n      if (controls && controls.current) {\n        controls.current.target.set(0, y, 0);\n        controls.current.update();\n      }\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [radius, height, width, adjustCamera]);\n  return /*#__PURE__*/React.createElement(\"group\", props, /*#__PURE__*/React.createElement(\"group\", {\n    ref: outer\n  }, /*#__PURE__*/React.createElement(\"group\", {\n    ref: inner\n  }, children)), contactShadow && /*#__PURE__*/React.createElement(ContactShadows, {\n    \"rotation-x\": Math.PI / 2,\n    opacity: contactShadowOpacity,\n    width: radius * 2,\n    height: radius * 2,\n    blur: contactShadowBlur,\n    far: radius / 2\n  }), environment && /*#__PURE__*/React.createElement(Environment, {\n    preset: environment\n  }), /*#__PURE__*/React.createElement(\"ambientLight\", {\n    intensity: intensity / 3\n  }), /*#__PURE__*/React.createElement(\"spotLight\", {\n    penumbra: 1,\n    position: [config.main[0] * radius, config.main[1] * radius, config.main[2] * radius],\n    intensity: intensity * 2,\n    castShadow: shadows,\n    \"shadow-bias\": shadowBias\n  }), /*#__PURE__*/React.createElement(\"pointLight\", {\n    position: [config.fill[0] * radius, config.fill[1] * radius, config.fill[2] * radius],\n    intensity: intensity\n  }));\n}\n\nexport { Stage };\n"]},"metadata":{},"sourceType":"module"}